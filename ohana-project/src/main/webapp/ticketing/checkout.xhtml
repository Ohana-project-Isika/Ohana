<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                template="/WEB-INF/templates/default.xhtml">


    <ui:define name="content">
<!--        <script type="text/javascript" src="#{request.contextPath}/resources/js/ticketing.js"></script>-->
        <link type="text/css" href="#{request.contextPath}/resources/css/styles.css" />

        <h:form id="test">

            <h:dataTable value="#{eventController.cart.events}" var="event">
                <h:column>
                    <f:facet name="header">Nom</f:facet>
                    #{event.name}
                </h:column>

                <h:column>
                    <f:facet name="header">Nombre de tickets</f:facet>
                    #{event.ticketQuantity}
                </h:column>

                <h:column>
                    <f:facet name="header">Tarif</f:facet>
                    #{event.ticket.rateType}
                </h:column>

                <h:column>
                    <f:facet name="header">Taux TVA</f:facet>
                    #{event.ticket.tvaRate} %
                </h:column>+

                <h:column>
                    <f:facet name="header">Prix HT</f:facet>
                    <p id="preTax_#{event.id}">#{event.ticket.preTaxPrice}</p>
                </h:column>

                <h:column>
                    <f:facet name="header">Prix TTC</f:facet>
                    <p id="postTax_#{event.id}">#{event.ticket.postTaxPrice}</p>
                </h:column>

                <h:column >
                    <h:commandButton action="#{eventController.decrement(event)}" value="-"/>
<!--                    <input class="fixedAmount" type="button" id="#{event.ticketQuantity}" "decrement('#{event.id}', '#{event.ticketQuantity}')" value="-"/>-->
                    <input class="dynamicAmount" id="#{event.id}" type="number" value="#{eventController.count}" min="1" max="#{event.ticketQuantity}"/>
                    <h:commandButton action="#{eventController.increment(event)}" value="+"/>
<!--                    <input type="button" onclick="increment('#{event.id}', '#{event.ticketQuantity}')" value="+"/>-->
                </h:column>

                <h:column >
                </h:column>

                <h:column>
                    <f:facet name="header">Total HT</f:facet>
                    <p id="subTotal_#{event.id}">#{event.ticket.subTotal}</p>
                </h:column>

                <h:column>
                    <f:facet name="header">Total TTC</f:facet>
                    <p id="total_#{event.id}">#{event.ticket.total}</p>
                </h:column>

                <h:column>
                    <f:facet name="header">Action</f:facet>
                    <input id="remove_#{event.id}" class="remove" type="button" value="Supprimer"/>
                </h:column>
            </h:dataTable>

            <f:facet name="header">Total Panier HT</f:facet>
            <p id="cartSubTotal">#{eventController.cart.subTotal}</p>
            <br/>

            <f:facet name="header">Total Panier TTC</f:facet>
            <p id="cartTotal">#{eventController.cart.total}</p>

            <a href="../ticketing.xhtml">Retour à la liste des événements</a>
            <a href="#"><p onclick="getVars('#{eventController.cart.subTotal}', '#{eventController.cart.total}')">Payer</p></a>
            <div hidden="hidden">
                <h:inputHidden id="subTotal" value="#{authorizePaymentController.cartSubTotal}" />
                <h:inputHidden id="total" value="#{authorizePaymentController.cartTotal}" />
                <h:commandLink id="link" action="#{authorizePaymentController.pay(eventController.cart)}"
                               value="click"/>

            </div>
        </h:form>

        <h:outputText id="msg" value="" binding="#{authorizePaymentController.component}"/>
        <h:message for="msg"/>
    </ui:define>
</ui:composition>
